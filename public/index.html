<html>
<title>web worker</title>
<link rel="stylesheet" href="./css/bootstrap.min.css">
<link rel="stylesheet" href="./css/main.css">
<script src="./js/marked.js"></script>

<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/agate.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<body>
  <div id="md">
  </div>
<script>
  hljs.initHighlightingOnLoad();
var mdTest = 
"## web worker 基础学习分享 \n"+ 
" ### 初见web worker \n" +
"![](./img/1.png)\n" +
"![](./img/2.png)\n "+
"> #### 一句话：通过web worker实现多线程操作\n"+
"[web worker不阻塞UI线程示例](./1.html)\n"+
"## web worker 语法简介\n"+
"#### 我们通过下面的语句来生成一个worker\n"+
"``` javascript\n"+
"var worker = new Worker('worker.js');\n"+
"```\n"+
"#### 需要注意的是，只有当url中对应的js文件加载成功后worker才会被创建\n"+
"#### worker被创建后，独立占用一个线程，该线程和主线程之间通过message通信。\n"+
"``` javascript\n"+
"worker.postMessage(DATA);//主线程向worker线程发送message信息\n"+
"worker.addEventListener('message', function(e) {//给worker添加一个message事件，用来响应从worker线程接收到的message\n"+
" console.log('Worker said: ', e.data);\n"+
"}, false);\n"+
"worker.onmessage = function(e){code}//或者也可以直接这样绑定\n"+
"```\n"+
"#### 而在worker.js中，写法也很简单\n"+
"``` javascript\n"+
"onmessage = function(event) {//onmessage用来接收主线程传来的message\n"+   
"  ...//code\n"+
"   postMessage(n);//postMessage用来向主线程发送message\n"+
"};\n  "+
"```\n"+
"#### Web Workers 不能自行停止，但是启动它们的页面可以通过调用 terminate() 方法停止它们。\n"+
"``` javascript\n"+
"worker.terminate();\n"+
"``` \n"+
"#### Web Workers 错误信息处理可以通过onerror来监听：\n"+
"``` js\n"+
"worker.onerror = function (event) {\n"+
"         console.log(event.message, event);\n"+
"};\n"+
"```\n"+
"#### web worker从定义上，分为两大类 \n * 专用线程：Dedicated Worker\n * 共享线程 Shared Worker\n\n"+
"#### 专用线程支持结构化的 JavaScript 数据格式(数组，对象)，也支持传输二进制数据。\n"+
"#### 在这里有一点需要注意，为了高效地传输 ArrayBuffer 对象数据，需要在 postMessage 方法中的第二个参数中指定它。实例代码如下：\n"+
"``` javascript\n"+
"worker.postMessage({ \n"+
 " operation: 'list_all_users', \n"+
 " //ArrayBuffer object \n"+
 " input: buffer, \n"+
 " threshold: 0.8, \n"+
"}, [buffer]);\n"+
"``` \n"+
"[web worker 数据传输示例](./2.html)\n"

document.getElementById('md').innerHTML =
      marked(mdTest);
</script>
</body>

</html>